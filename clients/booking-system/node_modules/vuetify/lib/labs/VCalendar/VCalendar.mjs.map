{"version":3,"file":"VCalendar.mjs","names":["makeVCalendarDayProps","VCalendarDay","makeVCalendarHeaderProps","VCalendarHeader","VCalendarMonthDay","makeCalendarProps","useCalendar","getDay","useDate","computed","chunkArray","genericComponent","propsFactory","useRender","makeVCalendarProps","hideHeader","Boolean","hideWeekNumber","weekdays","type","Array","default","VCalendar","name","props","emits","next","prev","setup","_ref","emit","slots","adapter","daysInMonth","daysInWeek","genDays","model","weekNumbers","dayNames","getWeekdays","onClickNext","viewMode","value","addMonths","addDays","onClickPrev","onClickToday","Date","title","format","calendarDayProps","filterProps","calendarHeaderProps","_createVNode","header","_mergeProps","hideDayHeader","length","sort","a","b","map","weekday","filter","day","includes","date","week","wi","isSameDay","undefined","events","e","start","end","i"],"sources":["../../../src/labs/VCalendar/VCalendar.tsx"],"sourcesContent":["// Styles\nimport './VCalendar.sass'\n\n// Components\nimport { makeVCalendarDayProps, VCalendarDay } from './VCalendarDay'\nimport { makeVCalendarHeaderProps, VCalendarHeader } from './VCalendarHeader'\nimport { VCalendarMonthDay } from './VCalendarMonthDay'\n\n// Composables\nimport { makeCalendarProps, useCalendar } from '@/composables/calendar'\nimport { getDay, useDate } from '@/composables/date/date'\n\n// Utilities\nimport { computed } from 'vue'\nimport { chunkArray, genericComponent, propsFactory, useRender } from '@/util'\n\nexport const makeVCalendarProps = propsFactory({\n  hideHeader: Boolean,\n  hideWeekNumber: Boolean,\n  weekdays: {\n    type: Array<number>,\n    default: () => [0, 1, 2, 3, 4, 5, 6],\n  },\n\n  ...makeCalendarProps(),\n  ...makeVCalendarDayProps(),\n  ...makeVCalendarHeaderProps(),\n}, 'VCalender')\n\nexport type VCalendarSlots = {\n  header: { title: string }\n}\n\nexport const VCalendar = genericComponent<VCalendarSlots>()({\n  name: 'VCalendar',\n\n  props: makeVCalendarProps(),\n\n  emits: {\n    next: null,\n    prev: null,\n    'update:modelValue': null,\n  },\n\n  setup (props, { emit, slots }) {\n    const adapter = useDate()\n\n    const { daysInMonth, daysInWeek, genDays, model, weekNumbers } = useCalendar(props as any)\n\n    const dayNames = adapter.getWeekdays()\n\n    function onClickNext () {\n      if (props.viewMode === 'month') {\n        model.value = [adapter.addMonths(model.value[0], 1)]\n      }\n      if (props.viewMode === 'week') {\n        model.value = [adapter.addDays(model.value[0], 7)]\n      }\n      if (props.viewMode === 'day') {\n        model.value = [adapter.addDays(model.value[0], 1)]\n      }\n    }\n\n    function onClickPrev () {\n      if (props.viewMode === 'month') {\n        model.value = [adapter.addMonths(model.value[0], -1)]\n      }\n      if (props.viewMode === 'week') {\n        model.value = [adapter.addDays(model.value[0], -7)]\n      }\n      if (props.viewMode === 'day') {\n        model.value = [adapter.addDays(model.value[0], -1)]\n      }\n    }\n\n    function onClickToday () {\n      model.value = [new Date()]\n    }\n\n    const title = computed(() => {\n      return adapter.format(model.value[0], 'monthAndYear')\n    })\n\n    useRender(() => {\n      const calendarDayProps = VCalendarDay.filterProps(props)\n      const calendarHeaderProps = VCalendarHeader.filterProps(props)\n\n      return (\n        <div class={[\n          'v-calendar',\n          {\n            'v-calendar-monthly': props.viewMode === 'month',\n            'v-calendar-weekly': props.viewMode === 'week',\n            'v-calendar-day': props.viewMode === 'day',\n          },\n        ]}\n        >\n          <div>\n            { !props.hideHeader && (\n              !slots.header ? (\n                <VCalendarHeader\n                  key=\"calendar-header\"\n                  { ...calendarHeaderProps }\n                  title={ title.value }\n                  onClick:next={ onClickNext }\n                  onClick:prev={ onClickPrev }\n                  onClick:toToday={ onClickToday }\n                />\n              ) : (\n                slots.header({ title: title.value })\n              )\n            )}\n          </div>\n\n          <div class=\"v-calendar__container\">\n            { props.viewMode === 'month' && !props.hideDayHeader && (\n              <div\n                class={\n                  [\n                    'v-calendar-weekly__head',\n                    `days__${props.weekdays.length}`,\n                    ...(!props.hideWeekNumber ? ['v-calendar-weekly__head-weeknumbers'] : []),\n                  ]\n                }\n                key=\"calenderWeeklyHead\"\n              >\n                { !props.hideWeekNumber ? <div key=\"weekNumber0\" class=\"v-calendar-weekly__head-weeknumber\"></div> : '' }\n                {\n                  props.weekdays.sort((a, b) => a - b).map(weekday => (\n                    <div class={ `v-calendar-weekly__head-weekday${!props.hideWeekNumber ? '-with-weeknumber' : ''}` }>\n                      { dayNames[weekday] }\n                    </div>\n                  ))\n                }\n              </div>\n            )}\n\n            { props.viewMode === 'month' && (\n              <div\n                key=\"VCalendarMonth\"\n                class={\n                  [\n                    'v-calendar-month__days',\n                    `days${!props.hideWeekNumber ? '-with-weeknumbers' : ''}__${props.weekdays.length}`,\n                    ...(!props.hideWeekNumber ? ['v-calendar-month__weeknumbers'] : []),\n                  ]\n                }\n              >\n                { chunkArray(daysInMonth.value\n                  .filter(day => props.weekdays.includes(getDay(adapter, day.date))), props.weekdays.length)\n                  .map((week, wi) => (\n                    [\n                      !props.hideWeekNumber ? <div class=\"v-calendar-month__weeknumber\">{ weekNumbers.value[wi] }</div> : '',\n                      week.filter(day => props.weekdays.includes(getDay(adapter, day.date))).map(day => (\n                        <VCalendarMonthDay\n                          color={ adapter.isSameDay(new Date(), day.date) ? 'primary' : undefined }\n                          day={ day }\n                          title={ day ? adapter.format(day.date, 'dayOfMonth') : 'NaN' }\n                          events={ props.events?.filter(e => adapter.isSameDay(day.date, e.start) || adapter.isSameDay(day.date, e.end)) }\n                        ></VCalendarMonthDay>\n                      )),\n                    ]\n                  ))}\n              </div>\n            )}\n\n            { props.viewMode === 'week' && (\n              daysInWeek.value.map((day, i) => (\n                <VCalendarDay\n                  { ...calendarDayProps }\n                  day={ day }\n                  dayIndex={ i }\n                  events={ props.events?.filter(e => adapter.isSameDay(e.start, day.date) || adapter.isSameDay(e.end, day.date)) }\n                ></VCalendarDay>\n              ))\n            )}\n\n            { props.viewMode === 'day' && (\n              <VCalendarDay\n                { ...calendarDayProps }\n                day={ genDays([model.value[0] as Date], adapter.date() as Date)[0] }\n                events={\n                  props.events?.filter(e =>\n                    adapter.isSameDay(e.start, genDays([model.value[0] as Date], adapter.date() as Date)[0].date) ||\n                    adapter.isSameDay(e.end, genDays([model.value[0] as Date], adapter.date() as Date)[0].date)\n                  )\n                }\n              ></VCalendarDay>\n            )}\n          </div>\n        </div>\n      )\n    })\n\n    return { daysInMonth, daysInWeek, genDays }\n  },\n})\n\nexport type VCalendar = InstanceType<typeof VCalendar>\n"],"mappings":"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"}